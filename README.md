# OpenEVSE-WiFi-esp8266-ui
<P>A simple HTML only user interface(UI) for the OpenEVSE project based on the ESP8266 and RAPI commands that will work with all browsers with or without a display for the OpenEVSE or internet connection.  This UI is full featured in that it will not only allow for status and full control of the OpenEVSE including modifying settings but also setting up the wireless module as an AP or STA and links to a database such as emoncms to create dashboards.  Below are some screen captures</P>
<p><img src="https://github.com/Energybrain/openevse-wifi-ui/blob/master/Home.jpeg">
<p>-----------------------------------------------------------
<p><img src="https://github.com/Energybrain/openevse-wifi-ui/blob/master/Advanced.jpeg">
<p>-----------------------------------------------------------
<p><img src="https://github.com/Energybrain/openevse-wifi-ui/blob/master/Wifi_config.jpeg">
<p>-----------------------------------------------------------
<p><img src="https://github.com/Energybrain/openevse-wifi-ui/blob/master/Send_rapi.jpeg">
<p>-----------------------------------------------------------
<p><img src="https://github.com/Energybrain/openevse-wifi-ui/blob/master/Set_date_time.jpeg">
<p>-----------------------------------------------------------
<p><img src="https://github.com/Energybrain/openevse-wifi-ui/blob/master/Set_delay_timer.jpeg">
<p>-----------------------------------------------------------
<P>This repository contains the source for both the OpenEVSE controller and ESP8266 WiFi module.  This is based off of the development version 4.3.2 from lincomatic/open_evse code (I've only included the modified files here, so you will need download the rest from lincomatic's repository at https://github.com/lincomatic/open_evse/tree/a4ec64b708b1461405699eb7a00aea509b77c08e and replace the like files with these and rebuild).  Also, you will need the WiFi module from <a href="http://openevse.com">openevse.com</a>.</P>
<P>I used the development version because it has a nice feature for solar charging and control i.e. the pilot adjust has the option of not saving to EEPROM.</P>
<P>Added a command to query the delay timer settings via RAPI in development version 4.3.2.  All UI code is done on the ESP8266 side.</P>
<P>Version is left as is with a 'b' attached to it indicating my modifications. </P>
<P>OpenEVSE Version with a 'c' suffix - fixes charge and time limits to work properly when using start delay timer.  Also included the use case where a delay timer is set and charges from the grid (TOU), stops when a limit is reached, and without unplugging from the car, charging can be restarted for solar power charging the next day.  As a consequence to having this use case, the kWh recording will not work properly due to no state A transitions so this include a fix that moves the kWh recording to be independant of state A transitions and only in chargingOff and chargingOn functions. Changes are marked with //bhc </P>
<P>OpenEVSE-WiFi-esp8266-ui - fixed time limit drop down menu bug and changed the choices to something more usable - every 30 minutes increments.  Also, will display custom allowed limits if set via the RAPI commands manually</P>
<P>OpenEVSE Version with a 'd' suffix - fixes a bug introduced of zeroing kWh recording when reset since reset uses chargingOff function before the accumulated kWh is read from EEPROM.  Also added a new RAPI command $GL to get the volatile flags to get the SetSleepLimit state to be more informative for the HTML ui.  Deleted RAPI command $SS because it is a duplicate of $SF.  $GL command is now supported by the UI to inform user of the SetSleepLimit state.</P>
<P>OpenEVSE Version with a 'e' suffix - added feature of detecting connector plugged in at anytime using one of the volatile flags.  Since the volatile flags can now be read via a RAPI command, one can write code to access this flag to send email notifications when a user forgets to plug the EVSE in at a predetermine time.  This added feature extends the program size to greater than 100% so a feature must be disable in order to include it. An updated ESP8266 firmware is also here if you want to see the status of the connector.  As always all the changes are marked with //bhc.</P>
<P>MAJOR UPDATE: Released v1.0 of the wifi firmware.  Most of the changes centered around making the EVSE easy to use without relying on a display.  Everything can be done and changed via a browser.  It will also work if not connected to a network in AP mode just no data logging.</P>
<P>Released v1.1 of the wifi firmware - OpenEVSE-WiFi-esp8266-ui.ino.  Added a "not plugged in and charging notifications via Emoncms" feature.   This feature will add two inputs OpenEVSE_P_NOTIFY and OpenEVSE_C_NOTIFY that will increment from 1 to 9.  1 is the initial notification and 2-9 are 8 reminders.  For example, one can use a home automation software or some scripting to link to an email server to send email notifiations or trigger any device when the OpenEVSE is not plugged into a car and/or charging by the set time(s).  Notifications will stop when it is plugged in or charging or both depending on user setting.  Also cleaned up code by reorganizing things a bit for better readabilty and troubleshooting.  Removed all the //bhc indicators.</P>
<p>Released v1.2 of the wifi firmware. Fixed a bug for the notification feature.  Also added the Arduino OTA library and server handler so the firmware updates can be done via the Arduino IDE by selecting the detected port.  Must first load this version via serial cable, connect to the same network as the IDE computer, restart IDE and make sure you have python 2.7x. Then select the OTA port in the IDE to upload wirelessly subsequent versions.</p>
<p>Released v1.2.1 of the wifi firmware.  Fixed a very minor notification bug.  Mostly cleaned up code and made UI more user friendly.</p>
<p>Released v1.2.2 of the wifi firmware.  More clean up and minor bug fixes.</p>
<p>Release v1.3 of the wifi firmware.  Allows a plugged in indicator to be sent to the servers as OpenEVSE_PLUGGED_IN.  Useful for home automation systems with solar.</p>

